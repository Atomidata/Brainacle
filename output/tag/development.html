<!DOCTYPE html>
<html lang="en">
<head>
        <title>Brainacle - development</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href=".././theme/css/main.css" type="text/css" />
        <link href=".././feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Brainacle ATOM Feed" />
        


        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie.css"/>
                <script src=".././js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
    <a href="#index" id="goto-top">TOP</a>
    <a href="#extras" id="goto-bottom">Links/Blogroll</a>

<a href="https://github.com/dekomote/Brainacle">

<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />

</a>

        <header id="banner" class="body">
                <h1><a href="../."><img src=".././theme/images/brainacle_logo.png" alt="Brainacle "/></a></h1>
                <nav><ul>
                    <li><a href="../.">Home</a></li>
                
                
                
                    <li><a href=".././pages/about.html">About</a></li>
                
                
                
                    <li ><a href=".././category/Sys.html">Sys</a></li>
                
                    <li ><a href=".././category/Coding.html">Coding</a></li>
                
                    <li ><a href=".././category/Miscellaneous.html">Miscellaneous</a></li>
                
                <li><a href=".././archives.html">Archives</a></li>
                </ul></nav>
        </header><!-- /#banner -->
                

        
    
        <aside id="featured" class="body"><article>
                <h1 class="entry-title"><a href=".././calculating-image-entropy-with-python-how-and-why.html">Calculating image entropy with Python, How and Why?</a></h1> 
                <footer class="post-info">
                        <abbr class="published" title="2010-10-04T12:20:00">
                                Mon 04 October 2010
                        </abbr>

                        
                        <address class="vcard author">
                                By <a class="url fn" href="#">Dejan Noveski</a>
                        </address>
                        
                <p>In <a href=".././category/Coding.html">Coding</a>. </p>
                <p>tags: <a href=".././tag/development.html">development</a> <a href=".././tag/entropy.html">entropy</a> <a href=".././tag/image.html">image</a> <a href=".././tag/pil.html">pil</a> <a href=".././tag/python.html">python</a> </p>
</p>
                </footer><!-- /.post-info -->
                <div class="section" id="the-why">
<h2>The Why?</h2>
<p>Lets say you are developing a video portal, kinda like youtube/vimeo
and you want to have an automated way of making thumbnails. Since
video manipulation in python is a bit tricky, you might as well make
the thumbnails with <strong>ffmpeg</strong> every [n] seconds. You need 10 thumbnails
for each video, and you want those thumbnails to show parts of it.</p>
<p>If you leave it random, you might end up having thumbnails that show
a black scene or some scene that barely shows anything. Using the
image
entropy, you can sort out the thumbnails based on the <a class="reference external" href="http://www.astro.cornell.edu/research/projects/compression/entropy.html">&quot;business&quot;</a> of
the scene they depict. The technique can be implemented as follows:</p>
<ol class="arabic simple">
<li>Generate n&gt;[thumbnails_needed] thumbnails</li>
<li>Calculate the image entropy for each of them</li>
<li>Sort them by their entropy</li>
<li>Use the first [thumbnails_needed] thumbnails</li>
</ol>
</div>
<div class="section" id="the-how">
<h2>The How?</h2>
<p><strong>Entropy</strong> H of a sampled signal of length N samples is calculated:</p>
<div class="highlight"><pre>H(X) = -1 * sum_1_to_N ( p_i log( p_i ) )
</pre></div>
<p>p_i is the probability of the i-th sample of the signal and can be calculated:</p>
<div class="highlight"><pre>p_i = Histogram(sample)[i]/Length(Histogram(sample))
</pre></div>
<p>All we need to do is to get the histogram list and we can calculate
the entropy.</p>
<p>On a first sight, this sounds like a complex mathematical problem. And
it is, but we will make a little shortcut. We will use the <a class="reference external" href="http://www.pythonware.com/products/pil/">Python
imaging library</a> or <strong>PIL</strong>. This package is de facto standard package for
image manipulation in Python. It is one of the first packages I
install when preparing my development environment (before making
virtualenvs). PIL provides a method for calculating the histogram of
the image and solves most of our problems. The function for
calculating the entropy looks like this:</p>
<div class="highlight"><pre>import Image
import math


def image_entropy(img):
    &quot;&quot;&quot;calculate the entropy of an image&quot;&quot;&quot;
    histogram = img.histogram()
    histogram_length = sum(histogram)

    samples_probability = [float(h) / histogram_length for h in histogram]

    return -sum([p * math.log(p, 2) for p in samples_probability if p != 0])

img = Image.open(&#39;headshot.jpg&#39;)
print image_entropy(img)
</pre></div>
<p>As you can see, PIL’s method for calculating the histogram really
simplifies things and makes the functions seem slim and simple. All
its left is iterating through set of thumbnails, calculating the
entropy and sorting them.</p>
<p>Remember: <strong>Bigger entropy means more
noise/liveliness/color/business.*</strong> You will usually need the thumbnails
with greater entropy.</p>
</div>

        </article></aside><!-- /#featured -->
        
            <section id="content" class="body">
                <h1>Other articles</h1>
                <hr />
                    <ol id="posts-list" class="hfeed">
        
    
        
     
        <li><article class="hentry">    
                <header>
                        <h1><a href=".././django-toolbox-for-komodo.html" rel="bookmark" title="Permalink to Django Toolbox for Komodo">Django Toolbox for Komodo</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
                        <abbr class="published" title="2010-05-03T16:08:00">
                                Mon 03 May 2010
                        </abbr>

                        <address class="vcard author">
                                By <a class="url fn" href="#">Vasil Vangelovski</a>
                        </address>
                        <p> In <a href=".././category/Coding.html">Coding</a></p>
                        <p>tags: <a href=".././tag/development.html">development</a> <a href=".././tag/editors.html">editors</a> <a href=".././tag/komodo.html">komodo</a> <a href=".././tag/django.html">django</a> </p>
</p>
                    <p></p>
                </footer><!-- /.post-info -->
                <p>If you’re using TextMate for Django development you’ve probably came
across the <a class="reference external" href="http://svn.textmate.org/trunk/Bundles/Python%20Django.tmbundle/">Python Django</a>
and Python <a class="reference external" href="http://svn.textmate.org/trunk/Bundles/Python%20Django.tmbundle/">Django Template</a> bundles.</p>
<p>The Django Toolbox for Komodo does most of what the TextMate bundles
do, plus integrated shortcuts for the most important links in the
Django docs. Builtin template filter support ...</p>
                <a class="readmore" href=".././django-toolbox-for-komodo.html">read more</a>
                </div><!-- /.entry-content -->
        </article></li>
    

</ol><!-- /#posts-list -->
</section><!-- /#content -->


        <section id="extras" class="body">
        
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                        
                            <li><a href="http://atomidata.com/">Atomidata</a></li>
                        
                            <li><a href="http://pressedweb.com/">Pressed Web</a></li>
                        
                            <li><a href="http://flyeyedesign.com">Flyeye Design</a></li>
                        
                            <li><a href="/archives.html">Archives</a></li>
                        
                        </ul>
                </div><!-- /.blogroll -->
        
        
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href=".././feeds/all.atom.xml" rel="alternate">atom feed</a></li>
                            

                        
                            <li><a href="http://twitter.com/dekomote">@dekomote</a></li>
                        
                            <li><a href="http://twitter.com/itarpeyo">@ItarPeyo</a></li>
                        
                            <li><a href="https://bitbucket.org/vvangelovski/">Vasil's Bitbucket</a></li>
                        
                            <li><a href="https://bitbucket.org/dekomote/">Dejan's Bitbucket</a></li>
                        
                            <li><a href="https://github.com/dekomote">Dejan's Github</a></li>
                        
                            <li><a href="https://github.com/vvangelovski">Vasil's Github</a></li>
                        
                            <li><a href="mailto:info@atomidata.com">Mail Us</a></li>
                        
                        </ul>
                </div><!-- /.social -->
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                &copy; Brainacle 2011 | Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">Pelican</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->


</body>
</html>